<% query_params = search.query_params || { :forced_labor_group => '*' } %>
<% search ||= Search.new %>

    <div class="baseContainerTeaser" style="clear: <%= cycle 'left', 'none' %>;">
        <div class="baseContainerTeaserImage">
            <%= link_to image_tag(result.still_image.url(:small)), interview_path(result), :title => result.short_title %>
        </div>
        <div class="baseContainerTeaserText">
            <h3><%= link_to result.short_title, interview_path(result), :title => result.short_title %></h3>
            <ul>
              <li class="languages"><%= result.language.split('/').map{|l| t(l.to_s, :scope => 'categories.languages')}.join(" / ") %><%= result.translated ? ' ' + content_tag(:span, '(' + t(:translated, :scope => 'status') + ')', :class => 'translated') : '' %></li>
              <li class="media_type"><%= result.video %> <span class="duration"><%= format_value result.duration %></span></li>
              <% additional_params = query_params.keys - [ 'languages', 'person_name', 'partial_person_name', 'fulltext', 'page', 'countries', 'forced_labor_fields' ] %>
              <% additional_params << 'countries' if additional_params.empty? && query_params['countries'].is_a?(Array) %>
              <% additional_params << 'forced_labor_fields' if additional_params.empty? && query_params['forced_labor_fields'].is_a?(Array) %>
              <% additional_params << 'forced_labor_groups' if additional_params.empty? %>
              <% additional_params.each do |attribute| %>
              <li class="<%= attribute %>">
                <span class='label'><%= Interview.human_attribute_name(attribute) %></span>
                <% if attribute == 'countries' %>
                    <%# don't translate %>
                <%= format_value result.send(attribute) %>
                <% else %>
                <%= format_value [ result.send(attribute) ].flatten.map{|a| t(a.to_s, :scope => "categories.#{attribute}")}.join(', ') %>
                <% end %>
              </li>
              <% end %>
            </ul>
        </div>
      <% if query_params.keys.include?('fulltext') %>
      <% matching_segments = search.matching_segments_for(result.archive_id) %>
        <% unless matching_segments.empty? %>
      <div id="interview_<%= result.archive_id.upcase %>_segments" class="baseContainerTeaserExcerpts" style="clear: left;">

        <h5><%= matching_segments.size == 0 ? 'keine Ausschnitte' : pluralize(matching_segments.size, 'Ausschnitt', 'Ausschnitte') %>
          <ul class="segment_pagination">
            <% matching_segments[0..8].each_with_index do |segment, index| %>
              <li id="<%= segment.media_id %>_link" <%= index == 0 ? " class='current'" : '' %>>
                <%= link_to_function (index+1).to_s, "showSegment('#{result.archive_id.upcase}','#{segment.media_id}')" %>
              </li>
            <% end %>
            <% if matching_segments.size > 9 %>
              <li>
                <%= link_to t(:more), interview_path(result) %>
              </li>
            <% end %>
          </ul>
        </h5>

        <% matching_segments[0..9].each_with_index do |segment, index| %>
        <div id="<%= segment.media_id %>" class="segment <%= index == 0 ? " visible" : '' %>">
          <span class="timecode"><%= segment.timecode %></span>
          <span class="tape"> <%= Tape.human_name + ' ' + segment.tape.number.to_s %></span>
          <p class="transcript">&ldquo;<%= segment_excerpt_for_match(segment, search.fulltext || '', 10)  %>&rdquo;</p>
          <%= link_to_segment segment %>
        </div>
        <% end %>

      </div>
        <% end %>
    <% end %>
    </div>