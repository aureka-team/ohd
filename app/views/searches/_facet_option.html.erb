<% facet_name = facet_option.first.to_s %>
<% facet_entries = facet_option.last %>
<% category_facet = facet_entries.empty? ? true : facet_entries.first.first.is_a?(Category) %>
<% fulltext_list = !category_facet && facet_entries.size < 13 %>

  <div class="fragmentTitle">
    <h2 onclick="toggleCategory('<%= facet_name %>_query', <%= !fulltext_list %>);">
      <img title="" src="/images/pfeil_rot_rechts.gif" id="<%= facet_name %>_query_closed" alt="Pfeil rechts" />
      <img title="" style="display:none" src="/images/pfeil_rot_unten.gif" id="<%= facet_name %>_query_open" alt="Pfeil unten" />
      <%= t facet_name.to_s.singularize %>
    </h2>
    <fieldset style="display:none" id="<%= facet_name %>_query" class="facet-field">
      <% unless facet_entries.empty? %>
        <% facet_selection = search_facets.object.send(facet_name.to_sym) || [] %>

        <% if category_facet %>
          <%# Category Facet %>

        <ul>
          <% facet_entries.each do |f| %>

            <% category = f.first %>

            <li>
                <%= check_box_tag "search[#{facet_name}][]", category[:id], facet_selection.include?(category[:id]), { :id => "#{facet_name}_#{category[:id]}", :class => facet_name } %>
                <span class="facet-name"><%= category.name %></span>
                <% if f.last != 0 %>
                <span class="facet-count">(<%= f.last %>)</span>
                <% end %>
            </li>

          <% end %>

        <% else %>
          <%# Fulltext Facet %>

          <%= search_facets.text_field :person_name, { :size => 25 } %>

        <% end %>
     </ul>
     <% end %>
    </fieldset>
  </div>
